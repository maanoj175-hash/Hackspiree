<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>My Applications - GramVidya</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark edu-navbar sticky-top">
      <div class="container">
        <a class="navbar-brand d-flex align-items-center gap-2" href="student.html">
          <i class="bi bi-mortarboard-fill brand-icon" aria-hidden="true"></i>
          <span class="fw-bold">GramVidya</span>
        </a>
        <div class="d-flex ms-auto">
          <a class="btn btn-light" href="student.html">Back</a>
        </div>
      </div>
    </nav>

    <main class="container py-5">
      <div class="mx-auto" style="max-width:820px">
        <h1 class="h4 mb-3">My Applications</h1>
        <p class="text-muted">Track simple application entries (demo). You can add a record and it will be saved locally.</p>

        <div class="card shadow-sm mb-4">
          <div class="card-body">
            <form id="appForm" class="row g-3">
              <div class="col-md-8">
                <input id="appTitle" class="form-control" placeholder="Application title (e.g., Scholarship)" />
              </div>
              <div class="col-md-4 d-grid">
                <button id="addApp" class="btn btn-primary">Add Application</button>
              </div>
            </form>
          </div>
        </div>

        <div class="card shadow-sm">
          <div class="card-body">
            <h6 class="card-title">Submitted Applications</h6>
            <div id="appsList" class="list-group mt-2"></div>
          </div>
        </div>
      </div>
    </main>

    <script>
      (function () {
        var form = document.getElementById('appForm');
        var title = document.getElementById('appTitle');
        var list = document.getElementById('appsList');

        function load() {
          try {
            var apps = JSON.parse(localStorage.getItem('gv_apps') || '[]');
            render(apps);
          } catch (e) { render([]); }
        }

        function render(apps) {
          list.innerHTML = '';
          if (!apps || apps.length === 0) {
            var empty = document.createElement('div');
            empty.className = 'list-group-item text-muted';
            empty.textContent = 'No applications yet.';
            list.appendChild(empty);
            return;
          }
          apps.forEach(function (a) {
            var it = document.createElement('div');
            it.className = 'list-group-item d-flex justify-content-between align-items-center';
            it.textContent = a.title + ' â€¢ ' + new Date(a.date).toLocaleString();
            var rem = document.createElement('button');
            rem.className = 'btn btn-sm btn-outline-danger';
            rem.textContent = 'Remove';
            rem.addEventListener('click', function () {
              remove(a.id);
            });
            it.appendChild(rem);
            list.appendChild(it);
          });
        }

        function remove(id) {
          try {
            var apps = JSON.parse(localStorage.getItem('gv_apps') || '[]');
            apps = apps.filter(function (x) { return x.id !== id; });
            localStorage.setItem('gv_apps', JSON.stringify(apps));
            load();
          } catch (e) {}
        }

        form.addEventListener('submit', function (ev) {
          ev.preventDefault();
          var t = (title.value || '').trim();
          if (!t) return;
          try {
            var apps = JSON.parse(localStorage.getItem('gv_apps') || '[]');
            apps.unshift({ id: 'a_' + Date.now(), title: t, date: new Date().toISOString() });
            localStorage.setItem('gv_apps', JSON.stringify(apps));
            title.value = '';
            load();
          } catch (e) {}
        });

        load();
      })();
    </script>

    <script>
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sw.js').catch(function (e) {
          console.warn('SW registration failed', e);
        });
      }
    </script>
  </body>
</html>